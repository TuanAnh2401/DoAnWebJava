<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}"></title>
    <th:block th:replace="~{user/layouts/_header::link-css}"></th:block>
</head>

<body>
<div th:replace="~{user/layouts/_header :: header}"></div>

<h1 id="username"></h1>

<div th:replace="~{user/layouts/_footer :: footer}"></div>

<script>
    // Lấy giá trị token từ localStorage
    var accessToken = localStorage.getItem("accessToken");

    // Gọi API hoặc sử dụng hàm giải mã token đã được định nghĩa để lấy thông tin username
    var decodedToken = parseJwt(accessToken);
    var username = decodedToken.sub; // Thay "sub" bằng trường chứa username trong token của bạn

    // Hiển thị username trong thẻ h1 có id "username"
    var usernameElement = document.getElementById("username");
    usernameElement.textContent = "Xin chào, " + username;

    // Hàm giải mã tokenn
    function parseJwt(token) {
        var base64Url = token.split(".")[1];
        var base64 = base64Url.replace(/-/g, "+").replace(/_/g, "/");
        var jsonPayload = decodeURIComponent(atob(base64).split("").map(function (c) {
            return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(""));

        return JSON.parse(jsonPayload);
    }
</script>
</body>
</html>
